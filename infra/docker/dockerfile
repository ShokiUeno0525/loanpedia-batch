# python-batch/Dockerfile
FROM python:3.12-slim

WORKDIR /app

# システムパッケージをインストール
RUN apt-get update && apt-get install -y \
    gcc \
    default-libmysqlclient-dev \
    pkg-config \
    && rm -rf /var/lib/apt/lists/*

# Python依存関係をインストール（リポジトリ直下の要件ファイルを使用）
# ビルドコンテキストはリポジトリルートを想定
COPY backend/batch/loanpedia_scraper/requirements.txt /tmp/requirements.txt
RUN pip install --no-cache-dir -r /tmp/requirements.txt

# 実行時のパス解決を安定化
ENV PYTHONPATH=/app

# 実行コマンドは docker-compose 側で上書き（デフォルトは待機）
CMD ["tail", "-f", "/dev/null"]
