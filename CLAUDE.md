# CLAUDE.md

このファイルは、このリポジトリでコードを操作する際に Claude Code (claude.ai/code) にガイダンスを提供します。

## プロジェクト概要

金融機関からローン情報を自動収集し、AI で処理してエンドユーザーに提供するローン情報集約システムです。月次データ収集サイクルでバッチ処理アーキテクチャを採用しています。

## システムアーキテクチャ

システムは線形パイプラインの 4 つの主要コンポーネントで構成されています：

1. **データ収集 (Python)**: 金融機関の Web サイトからローン情報を抽出する Web スクレイピングバッチジョブ
2. **データ処理 (AI)**: BedRock API を使用してローンデータを要約・構造化
3. **データ保存 (MySQL)**: 元データ、処理済み要約、タイムスタンプ、ソース情報を保存
4. **ユーザーインターフェース (PHP Laravel + React)**: エンドユーザーがローンデータにアクセスするための API と Web インターフェース

## 主要コンポーネント

### バッチ処理レイヤー

- データ収集の月次スケジュール実行
- 金融機関 Web サイトの Web スクレイピング
- エラーハンドリングとリトライメカニズム
- データ検証とクリーニング

### AI 処理レイヤー

- ローンデータ要約のための BedRock API 統合
- 非構造化 Web コンテンツからの構造化データ生成
- 一貫したデータ表示のための標準化フォーマット変換

### データレイヤー

- 永続化ストレージのための MySQL データベース
- 生のスクレイピングデータと処理済み要約の分離保存
- メタデータトラッキング（更新タイムスタンプ、データソース）
- エンドユーザーアクセスのための効率的なクエリ

### API レイヤー

- データアクセスのための Laravel ベース REST API
- ユーザーインターフェースのための React フロントエンド
- アクセス制御とデータセキュリティ対策

## 開発環境

このプロジェクトは、標準的な Python .gitignore 設定でバッチ処理に Python を使用しています。コードベースは現在、最小限のファイルで初期セットアップ段階にあります。

## プロジェクト構造

```
loanpedia-batch/
├── docs/requirements.md    # 詳細な要件仕様書
├── README.md              # 基本的なプロジェクト情報
└── .gitignore            # Python フォーカスの ignore パターン
```

## 要件ドキュメント

完全なシステム要件は `docs/requirements.md` に文書化されており、以下を含みます：

- 各システムコンポーネントの機能要件
- 非機能要件（パフォーマンス、可用性、セキュリティ）
- 各レイヤーの技術仕様
- システム統合フロー

## 技術スタック

- **バックエンド**: Python（バッチ処理）、PHP Laravel（API）
- **フロントエンド**: React
- **データベース**: MySQL
- **AI**: BedRock API
- **インフラ**: Web スクレイピングツール、スケジューリングシステム

## 注意事項

- ユーザーとは日本語でやり取りすること
- コミットメッセージは日本語で作成

## Git 運用ルール

### ブランチ戦略

- **main**: プロダクション用の安定したブランチ
- **develop**: 開発用の統合ブランチ
- **feature/***: 機能開発用ブランチ（例：feature/loan-scraper）
- **bugfix/***: バグ修正用ブランチ（例：bugfix/scraper-timeout）
- **hotfix/***: 緊急修正用ブランチ（例：hotfix/api-security）

### コミットメッセージ規約

```
種別: 概要（50文字以内）

詳細説明（必要に応じて）
- 変更内容の詳細
- 変更理由
- 影響範囲
```

**種別例:**

- feat: 新機能
- fix: バグ修正
- docs: ドキュメント更新
- refactor: リファクタリング
- test: テスト追加・修正

### プルリクエスト運用

1. **作成前チェック**

   - テストが通ることを確認
   - コードレビューの観点を考慮
   - 関連するドキュメントの更新

2. **PR 説明**
   - 変更概要
   - 変更理由
   - テスト方法
   - 影響範囲

### 開発フロー

1. `main` から `feature/*` ブランチを作成
2. 機能開発・テスト実装
3. プルリクエスト作成
4. コードレビュー
5. `main` へマージ
6. 不要なブランチの削除

### 禁止事項

- `main` ブランチへの直接プッシュ
- 強制プッシュ（`git push --force`）
- 機密情報（API キー、パスワード等）のコミット
- 大量のファイル変更を含む単一コミット

### 推奨事項

- 小さく頻繁なコミット
- わかりやすいコミットメッセージ
- 定期的なリベース（`git rebase`）
- `.gitignore` の適切な管理
- タグを使用したリリース管理

### セキュリティ対策

- `.env` ファイルの除外
- 機密情報の分離管理
- 依存関係の定期的な更新
- セキュリティアラートへの迅速な対応


## Active Technologies
- TypeScript 5.6.3 + aws-cdk-lib 2.215.0, aws-cdk/aws-route53 (001-route53-hosted-zone)
- N/A（インフラ定義のみ） (001-route53-hosted-zone)

## Recent Changes
- 001-route53-hosted-zone: Added TypeScript 5.6.3 + aws-cdk-lib 2.215.0, aws-cdk/aws-route53
